{"data":{"site":{"siteMetadata":{"title":"Rem Lampa: On Web Development, Startups & Film Photography","author":"Rem Lampa"}},"markdownRemark":{"id":"67a3a470-589a-545a-aa3c-5f1989c1f1c9","excerpt":"There will come a point when there’s a piece of JavaScript code that you wrote that often gets used in your projects, and you end up copying and pasting it…","html":"<p>There will come a point when there’s a piece of JavaScript code that you wrote that often gets used in your projects, and you end up copying and pasting it across all projects that need it.</p>\n<p>If you’ve experienced this, I’ve come to tell you that there is definitely a better way of sharing pieces of JavaScript code between your projects: create a local NPM package!</p>\n<h3>TL;DR</h3>\n<p>The code for the NPM package is available at <a href=\"https://github.com/RemLampa/npm-package-tutorial\">https://github.com/RemLampa/npm-package-tutorial</a>.</p>\n<p>For a sample of how to import it into a local project: <a href=\"https://github.com/RemLampa/npm-package-demo\">https://github.com/RemLampa/npm-package-demo</a>.</p>\n<h3>First Things First</h3>\n<p>For the sake of clarity, let me just define a few terms that I used for the remainder of this article:</p>\n<ul>\n<li><code class=\"language-text\">npm package</code> - A library/framework/piece of code that can be shared among any number of JavaScript projects. I will also refer to it as simply <code class=\"language-text\">package</code>.</li>\n<li><code class=\"language-text\">project</code> - Any code that reuses a <code class=\"language-text\">package</code>.</li>\n</ul>\n<p>For this tutorial, we will not do anything wild. The package will just be a simple Node script that will print a simple message on the console.</p>\n<p>I don’t know if this matters, but I’m running Node v.10.15.0 at the time of this writing. So if you run into bugs, you might want to look into that.</p>\n<h3>Setting Up</h3>\n<p>Create two folders, one for the package and another for a sample project that will install and demo the package, and run <code class=\"language-text\">npm init</code> on both of them. Name the package and project folders as <code class=\"language-text\">npm-package-tutorial</code> and <code class=\"language-text\">npm-package-demo</code>, respectively. Optionally, you may also run <code class=\"language-text\">git init</code> to create repositories for each folder.</p>\n<p>Go to the package directory and create a folder named <code class=\"language-text\">src</code>, and inside it create a file named <code class=\"language-text\">index.js</code>.</p>\n<p>Go to the project directory and create a file named <code class=\"language-text\">index.js</code> at the root.</p>\n<h3>Dive into the Code</h3>\n<p>Add the following into <code class=\"language-text\">npm-package-tutorial/src/index.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">printFromPackage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello from package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> printFromPackage<span class=\"token punctuation\">;</span></code></pre></div>\n<h3>Making the Package Available to Local Projects</h3>\n<p>If you’re a masochist like me, you’d probably import the package into <code class=\"language-text\">npm-package-demo/index.js</code> relatively:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> printFromPackage <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../npm-package-tutorial/src'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>That’s well and good, but what if the file you want the package to import into is several folders deep inside your OS file system? You may end up with the “Dot-Dot Hell”:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> printFromPackage <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../../../../../../../../Documents/projects/npm-package-tutorial/src'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Looks awful, doesn’t it?</p>\n<p>Luckily, NPM (and Yarn) has a utility that allows absolute imports for local packages: <strong>Package Linking</strong>!</p>\n<p>I’ll take a gradual approach in developing the package, hoping that it’ll be easy for beginners to follow.</p>\n<p>First, let’s edit <code class=\"language-text\">npm-package-demo/index.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> printFromPackage <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'npm-package-tutorial'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">printFromPackage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Let’s run the demo:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">cd</span> /path/to/npm-package-demo\n$ node index.js</code></pre></div>\n<p>We’ll be encountering an error similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">internal/modules/cjs/loader.js:583\n    throw err<span class=\"token punctuation\">;</span>\n    ^\n\nError: Cannot <span class=\"token function\">find</span> module <span class=\"token string\">'npm-package-tutorial'</span>\n    at Function.Module._resolveFilename <span class=\"token punctuation\">(</span>internal/modules/cjs/loader.js:581:15<span class=\"token punctuation\">)</span></code></pre></div>\n<p>This is expected since there is no package named <code class=\"language-text\">npm-package-tutorial</code> installed in the project yet.</p>\n<p>Let’s do that. Open up <code class=\"language-text\">npm-package-demo/package.json</code> and add this under dependencies:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"npm-package-tutorial\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then let’s install it:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span></code></pre></div>\n<p>Again, we are met with another error:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> code E404\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404 Not Found - GET https://registry.npmjs.org/npm-package-tutorial - Not found\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404  <span class=\"token string\">'npm-package-tutorial@latest'</span> is not <span class=\"token keyword\">in</span> the <span class=\"token function\">npm</span> registry.\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404 Your package name is not valid, because\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404  1. name can only contain URL-friendly characters\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404 It was specified as a dependency of <span class=\"token string\">'npm-package-demo'</span>\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404 Note that you can also <span class=\"token function\">install</span> from a\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> 404 tarball, folder, http url, or <span class=\"token function\">git</span> url.\n\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span> A complete log of this run can be found in:\n<span class=\"token function\">npm</span> ERR<span class=\"token operator\">!</span>     /some-folder-in-your-filesystem/.npm/_logs/2019-03-04T05_24_10_963Z-debug.log</code></pre></div>\n<p>By default, NPM will try to download the package from its online registry (<a href=\"https://registry.npmjs.org\">https://registry.npmjs.org</a>).</p>\n<p>We will have to tell NPM to find the package from our local environment on our development machine instead. We do this by first calling <code class=\"language-text\">npm link</code> inside our package directory:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">cd</span> /path/to/npm-package-tutorial\n$ <span class=\"token function\">npm</span> <span class=\"token function\">link</span>\n<span class=\"token function\">npm</span> notice created a lockfile as package-lock.json. You should commit this file.\n<span class=\"token function\">npm</span> WARN npm-package-tutorial@1.0.0 No description\n\nup to <span class=\"token function\">date</span> <span class=\"token keyword\">in</span> 1.148s\nfound 0 vulnerabilities\n\n/path/to/lib/node_modules/npm-package-tutorial -<span class=\"token operator\">></span> /path/to/npm-package-tutorial</code></pre></div>\n<p><code class=\"language-text\">npm link</code> just created a local package link and made it available in our development environment and named it according to the <code class=\"language-text\">name</code> property provided in the current directory’s <code class=\"language-text\">package.json</code>.</p>\n<p>So if we run <code class=\"language-text\">npm install</code> again inside our project directory, it will now recognize our local package, right? Not quite.</p>\n<p>We still need to explictly tell NPM that our project should search for <code class=\"language-text\">npm-package-tutorial</code> from our local “registry”, again using <code class=\"language-text\">npm link</code> but this time, providing the name of the linked package:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">cd</span> /path/to/npm-package-demo\n$ <span class=\"token function\">npm</span> <span class=\"token function\">link</span> npm-package-tutorial\n/path/to/npm-package-demo/node_modules/npm-package-tutorial -<span class=\"token operator\">></span> /path/to/lib/node_modules/npm-package-tutorial -<span class=\"token operator\">></span> /path/to/npm-package-tutorial</code></pre></div>\n<p>Compare the paths from the ones we got from the link we did inside <code class=\"language-text\">npm-package-tutorial</code>. Notice any similarities?</p>\n<p>Now let’s install the package:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span></code></pre></div>","frontmatter":{"title":"Creating a Local Private NPM Package","date":"February 19, 2019"}}},"pageContext":{"slug":"/creating-local-private-npm-package/","previous":{"fields":{"slug":"/starting-over/"},"frontmatter":{"title":"Starting Over"}},"next":{"fields":{"slug":"/fostering-an-inclusive-philippine-startup-community/"},"frontmatter":{"title":"Fostering an Inclusive Philippine Startup Community"}}}}